# 特征根求解线性递推方程


主要目的：利用特征根，通过递推关系式求通项公式

一篇非常好的讲解：[怎么用特征根法和不动点法求数列的通项公式? - 灵剑的回答 - 知乎](https://www.zhihu.com/question/51662733/answer/126920544)

本文进行一个梳理，内容包括：
1. 线性递推方程
2. 特征根原理
3. 线性齐次方程组求解
4. 非线性其次方程组求解



### 线性递推方程

$a_n+p_{k-1}a_{k-1}+p_{k-2}a_{k-2}+...p_1a_{n-k}=f(n)$

- $p_0 \not= 0$: k 阶线性递推方程
- $f(n)=0$: k 阶齐次线性递推方程
- $f(n)\not=0$: k 阶非齐次线性递推方程



### 线性无关

定义：对于基底（base）：$\{b_n^{(1)}\}，\{b_n^{(2)}\}，\{b_n^{(3)}\}\cdots$，如果线性组合 $\alpha_1\{b_n^{(1)}\}+\alpha_2\{b_n^{(2)}\}+\alpha_3\{b_n^{(3)}\}\cdots = 0$ 只在 $\alpha_1 = \alpha_2 = \cdots = 0$ 时成立，则这些基底线性无关。

解释：基底之间无法通过线性组合互相表示。

意义：一组线性无关的基底是一个方程式的一组解，那么基底的线性组合肯定也是这个方程式的解。



### 齐次递推求通项

对于齐次递推方程：$a_n=p_{k-1}a_{k-1}+p_{k-2}a_{k-2}+...p_1a_{n-k}$

给定数列前 k 项数据，则从 k+1 项开始，可以由前 k 项数据递推得到。

**那么如何根据这个递推方程求得 $a_n$ 的通项公式呢？**



对应的齐次方程：$a_n+ p_{k-1}a_{k-1}+p_{k-2}a_{k-2}+...p_1a_{n-k} = 0$（可以忽略 p 的正负性）

对应的线性无关基底： $\{b_n^{(1)}\}，\{b_n^{(2)}\}，\{b_n^{(3)}\}\cdots\{b_n^{(k)}\}$（为什么是 k 个基底，需进一步完善证明）

由前文的知识得到：${a_n}$ 数列中的任何一项都是齐次方程的解，所以 $a_n$ 可以用基底表示

不妨假设 $a_n=\alpha_1\{b_n^{(1)}\}+\alpha_2\{b_n^{(2)}\}+\alpha_3\{b_n^{(3)}\}\cdots\alpha_k\{b_n^{(k)}\}$，（$\alpha_1 \cdots \alpha_k$ 是 k 个常数系数）

这时我们再带入前 k 项，得到 k 个方程，刚好 k 个未知数，则可以求出 $\alpha_1 \cdots \alpha_k$ 的值，也就得到了通项公式。



总结思路：

1. 改写为齐次方程
2. 求得 k 个线性无关的解（基底）
3. 写出带未知数 $\alpha_1 \cdots \alpha_k$ 的 $a_n$ 的通项公式
4. 带入前 k 项数列的值，解出未知数，得到通项公式



### 齐次方程求基底：特征根

结论：可以用一组特殊的等比数列作为基底

> 我们求出一组特殊的等比数列的解来作为基底。为什么想到选择等比数列可以扯到母函数、z-变换等一系列问题上，我们不发散思路



对于齐次方程：$a_n+ p_{k-1}a_{k-1}+p_{k-2}a_{k-2}+...p_1a_{n-k} = 0$

假设 $a_n=\alpha_1\{b_n^{(1)}\}+\alpha_2\{b_n^{(2)}\}+\alpha_3\{b_n^{(3)}\}\cdots\alpha_k\{b_n^{(k)}\}$

将等比数列作为基底：$b_n=x^n$

（可以不用考虑系数，因为线性相关的思想，带上系数只是一个可约分的比例而已）

此时也可以得到：$a_n = x^n$（同样原因也可以不用考虑系数）

带入之后也就是：$x^n+ p_{k-1}x^{n-1}+p_{k-2}x^{n-2}+...p_1x^{n-k} = 0$

约分之后得到所谓的**特征方程**：$x^k+ p_{k-1}x^{k-1}+p_{k-2}x^{k-2}+...p_1 = 0$

一元 k 次方程，一共 k 个解（算复数根），即所谓的**特征根**，可以记为 $x_0,x_1\cdots x_{k-1}$

k 个特征根线性无关（利用范德蒙矩阵的性质证明），所以这 k 个特征根可以作为基底

那么 $a_n = \alpha_1 x_0^n+\alpha_2 x_1^n + \cdots \alpha_k x_{k-1}^n$

之后再带入前 k 项数列的值即可求出通项公式 $a_n$



如果有重根怎么办？

结论：如果有重根 $x_i$，依次用 $nx_i^{n-1},n^2x_i^{n-2}\cdots$ 来补足



思路总结：

1. 将等比数列作为基底（仅用作原理）
2. 得到特征方程
3. 求解特征根，n 次方即基底，如果有重根需要进行补足



### 非齐次递推求解：不动点

结论：非齐次方程的解 = 特解 + 通解

原理：线性思想

> 非齐次的情况其实没有想象的那么复杂，我们去掉最右边的$f(n)$得到一个齐次方程，用前面的方法，我们已经可以求出这个齐次方程的解。现在如果我们有任意一个非齐次方程的解$\{c_n\}$，和任意一个相应齐次方程的解$\{b_n\}$，则显然$\{b_n+c_n\}$也是相应非齐次方程的解。跟齐次的情况相同，也是前k项完全决定了后面项的值。
>
> 因此非齐次方程的解可以表示为：任意一个非齐次方程的解 + 齐次方程的解的基底的线性组合

所以针对非齐次的递推，我们只需要额外再求出特解就好了。

不动点法：假设 $a_n=a_{n-1}=\cdots a_1$，带入原方程解得的 $a_n$，就是特解

原理：递推公式求极限



### 总结：递推公式求通项公式

**原理过程**

1. 线性递推公式 $\Leftrightarrow$ 线性(非)齐次方程组
2. 线性无关：一组线性无关的基底是一个方程式的一组解，那么基底的线性组合肯定也是这个方程式的解
3. 所以通项公式 $a_n$ 可以用基底的线性组合表示
4. 假设等比数列作为基底可以推出特征方程
5. 齐次：特征根 $\Rightarrow$ 基底 $\Rightarrow$ 通项公式 $a_n$ 表达式
6. 非齐次：（特征根 $\Rightarrow$ 基底，不动点 $\Rightarrow$ 特解） $\Rightarrow$ 通项公式 $a_n$ 表达式
7. 带入前 k 项就可以解除未知常参，得到完整通项 $a_n$

**操作过程**

1. 改写为齐次方程，得到特征方程
2. 求出特征根
3. 非齐次方程利用不动点求出特解
4. 得到带参数的通项公式
5. 带入前 k 项解出最终通项